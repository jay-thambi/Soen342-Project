{% extends 'base.html' %}

{% block title %}Client Dashboard{% endblock %}

{% block content %}
<h2>Welcome, {{ current_user.name }}!</h2>

<h3>Your Profiles</h3>
<ul>
    {% for client in clients %}
    <li>{{ client.name }} (DOB: {{ client.date_of_birth }})</li>
    {% endfor %}
</ul>

<p><a href="{{ url_for('client.add_dependent') }}">Add Dependent</a></p>

<h3>Your Bookings</h3>
{% if bookings %}
<table>
    <tr>
        <th>Client</th>
        <th>Lesson Type</th>
        <th>Date</th>
        <th>Time</th>
        <th>Instructor</th>
        <th>Location</th>
        <th>Status</th>
        <th></th>
    </tr>
    {% for booking in bookings %}
    <tr>
        <td>{{ booking.client.name }}</td>
        <td>{{ booking.session.lesson.lesson_type.name }}</td>
        <td>{{ booking.session.date.strftime('%Y-%m-%d') }}</td>
        <td>{{ booking.session.start_time.strftime('%H:%M') }} - {{ booking.session.end_time.strftime('%H:%M') }}</td>
        <td>{{ booking.session.lesson.assigned_instructor.user.name }}</td>
        <td>{{ booking.session.lesson.location.name }}</td>
        <td>{{ booking.status }}</td>
        <td>
            <form method="post" action="{{ url_for('client.delete_booking', booking_id=booking.id) }}" onsubmit="return confirm('Are you sure you want to cancel this booking?');">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                <button type="submit" class="btn btn-danger btn-sm">Cancel Booking</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
{% else %}
<p>You have no bookings yet.</p>
{% endif %}

<p><a href="{{ url_for('client.view_lessons') }}">View Available Offerings</a></p>
{% endblock %}
